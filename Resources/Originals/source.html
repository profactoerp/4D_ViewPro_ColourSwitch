<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>SpreadJS Designer</title>
	<link href="@css1" rel="stylesheet" type="text/css" />
	<link href="@css2" rel="stylesheet" type="text/css">
	<link href="./custom.css" rel="stylesheet" type="text/css">
	<style type="text/css">
		html,
		body {
			overflow: hidden;
			padding: 0;
			margin: 0;
			height: 100%;
		}

		#gc-designer-container {
			height: 100%;
		}
	</style>
</head>

<body unselectable="on">
	<div class="loading-placeholder background-mask-layer"></div>
	<span class="loading-placeholder loading-pic"></span>
	<div id="ss"></div>
	<div id="gc-designer-container">
	</div>
	<!-- run minified source -->
	<script src="../../scripts/getTimezoneOffset.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.all.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.charts.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.shapes.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.print.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.barcode.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.pdf.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.sheets.tablesheet.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.excelio.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.pivot.pivottables.14.1.1.min.js"></script>
	<script src="../../SpreadJS/scripts/gc.spread.calcengine.languagepackages.14.1.1.min.js"></script>
	<!-- -->

	<!-- run non minified source --
<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/gc.spread.sheets.all.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.sheets.charts.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.sheets.shapes.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.sheets.print.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.sheets.barcode.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.sheets.pdf.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/interop/gc.spread.excelio.14.1.1.js"></script>
	<script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/SpreadJS.14.1.1/scripts/plugins/gc.spread.calcengine.languagepackages.14.1.1.js"></script>
<-- -->

	<!-- Load localized resource file -->
	<script src="../../SpreadJS/scripts/jquery-2.0.2.min.js"></script>
	<script src="../../scripts/localizedFolder.js"></script>
	<script>
		(function () {

			let lang = vp_localizedFolder.substring(0, 2);

			if ((lang === 'ja') || (lang === 'fr') || (lang === 'cs') || (lang === 'de') || (lang === 'es') || (lang === 'pt')) {
				$.ajax({
					async: false,
					url: '../../' + vp_localizedFolder + '/gc.spread.sheets.resources.' + lang + '.14.1.1.min.js',
					dataType: "script"
				});
			}

			let src = '';
			if (vp_localizedFolder === '') {
				src = '../../en.lproj/gc.spread.sheets.designer.resource.en.14.1.1.min.js';
			} else {
				src = '../../' + vp_localizedFolder + '/gc.spread.sheets.designer.resource.' + lang + '.14.1.1.min.js';
			}

			$.ajax({
				async: false,
				url: "@js1",
				dataType: "script"
			});

			// change the hardcoded fonts in the resources with system fonts
			if (vp_fonts.length > 0) {
				let ff_fonts = {};
				let font_list = {};

				for (let i = 0; i < vp_fonts.length; i++) {
					var value = vp_fonts[i].replace(/"/g, '');
					ff_fonts["ff" + (i + 1)] = { name: vp_fonts[i], text: value };
					font_list[vp_fonts[i]] = vp_fonts[i];
				}

				GC.Spread.Sheets.DesignerRes.res.fontPicker.fontFamilies = font_list; // {Arial:"Arial",Times:"Times",...}
				GC.Spread.Sheets.DesignerRes.res.ribbon.fontFamilies = ff_fonts; // {ff1:{name:'Arial',text:'Arial'},ff2...}

				// call the language package to translate the command names
				if ((vp_localizedFolder != '') && (vp_localizedFolder != 'en.lproj')) {
					GC.Spread.CalcEngine.LanguagePackages.languagePackages(lang);
				}
			}

		})();
        //# sourceURL=localizationStuff1.js
	</script>

	<script src="../../scripts/custom-designer-functions.js"></script>

	<!-- -------------- -->
	<!-- run minified -->
	<script src="@js2"></script>

	<!-- run unminified -->
	<!--script src="file:///C:/Perforce/4eDimension/main/ThirdParty/SpreadJS/Designer.14.1.1.custom/gc.spread.sheets.designer.all.14.1.1.js"></script-->

	<!-- -------------- -->

	<script>
		(function () {

			let lang = vp_localizedFolder.substring(0, 2);

			if ((lang === 'ja') || (lang === 'fr') || (lang === 'cs') || (lang === 'de') || (lang === 'es') || (lang === 'pt')) {
				$.ajax({
					async: false,
					url: '../../' + vp_localizedFolder + '/contextMenu.js',
					dataType: "script"
				});
			} else {
				$.ajax({
					async: false,
					url: '../../en.lproj/contextMenu.js',
					dataType: "script"
				});
			}

		})();
        //# sourceURL=localizationStuff2.js
	</script>
	<script>
		(function () {

			let lang = vp_localizedFolder.substring(0, 2);

			if ((lang === 'ja') || (lang === 'fr') || (lang === 'cs') || (lang === 'de') || (lang === 'es') || (lang === 'pt')) {
				$.ajax({
					async: false,
					url: '../../' + vp_localizedFolder + '/config.js',
					dataType: "script"
				});
			}

		})();
        //# sourceURL=localizationStuff3.js
	</script>


	<!-- View Pro specific -->
	<script src="../../scripts/init.js"></script>
	<script src="../../scripts/utils.js"></script>
	<script src="../../scripts/custom-types.js"></script>
	<script src="../../scripts/custom-function-helpers.js"></script>
	<script src="../../scripts/custom-functions.js"></script>

	<script src="../../4dviewpro.js"></script>

	<!-- View Pro Commands -->
	<script src="../../scripts/commands/values.js"></script>
	<script src="../../scripts/commands/file.js"></script>
	<script src="../../scripts/commands/print.js"></script>
	<script src="../../scripts/commands/style.js"></script>
	<script src="../../scripts/commands/names.js"></script>
	<script src="../../scripts/commands/sheets.js"></script>
	<script src="../../scripts/commands/events.js"></script>
	<script src="../../scripts/commands/utilities.js"></script>
	<script src="../../scripts/commands/spans.js"></script>
	<script src="../../scripts/commands/rows-and-columns.js"></script>

	<script type="text/javascript">
		var spread = null;
		var designer = null;
		var config = null;
		window.onload = function () {

			GC.Spread.Sheets.LicenseKey = "726569186466893#B0lL3JWZhFWT7gTO8hTdoFUTzsUOLZWRohValRGNC34Q9ZXerNDUXR4SSdjeysWaKNFd48maFNWOKNXNLlFdQhHeNhFdHB7crAjRnhkeDl4VCB5cr8EdKlXetVTb7hHMalFUEV4LIVmRFRFd6UlViZzdIVTd5NneIZmZ6p4asRmYJtkUTplUyElQ79GMjdHbh3UQO3keCVTTvRDcUFFdutkVPpkcxk5VPBlWpNkcSJjcVxWSLJEc7N4UnBVYypGSDx6ZkNDdEhmQyAHTzZ7U5lGayhUaSJnU4kTZiRTZDJiOiMlIsISN8QTOEVTNyIiOigkIsADM9czNzgTN0IicfJye#4Xfd5nIFVUSWJiOiMkIsICNx8idgAyUKBCZhVmcwNlI0IiTis7W0ICZyBlIsICNzcTN6ADIyIjMxAjMwIjI0ICdyNkIsIyUBNFIERjI0ISYONkIsIyM9gjN6QjN8ETO6UjNycjI0ICZJJCL3V6csFmZ0IiczRmI1pjIs9WQisnOiQkIsISP3E4N9ATVpJTbp3URQZzRuhTS8clb59mNtdEVxVVaHR6dPljUi5EMJJzbthFNnxmd7ZGMJlWMrtyR7AFWiRGanx6UzUEZzEzKxgHcElTWhhTZ5lkM85mRa5GM9xWdW54aihVSm3meXRWYOdDUwJzYHhDZr9WargSTgx";
			GC.Spread.Sheets.Designer.LicenseKey = "851559255358462#B0rTDTQvJTQYljRU3kVCVTT5JDMlJ5U5VjVaBlV7UDMyYDVYZkZpp7LHhTThtUQXtWRshHatVneCJWVRtyYU54U6o7dxglZuRjY6Emaxd6c84GcSl5YLJmSzkVMqhjRxUmZ68kZkdTZyRUd5lzaLBTZ9syb8ElQlplUywkWB3ma7p7Txo5SzhkQ5NlSqNWdMlVWHdnMx34RPN6KKJEUnRkQ5B7QuFUanJmVBNTNt5GSnJ7dT9WMnJ5UUNHcKNVUmRzVOFzZ8UUa6dTUjNEWHNnTYNkSUFXc8knNRJiOiMlIsIiNwIEOEVUMyIiOigkIsEzM8MTN6UTO0IicfJye&Qf35VfiklNFdjI0IyQiwiI4EjL6BibvRGZB5icl96ZpNXZE5yUKRWYlJHcTJiOi8kI1tlOiQmcQJCLikDMwAzNwAiMyITMwIDMyIiOiQncDJCLiMVQTBCR4IiOiEmTDJCLiIjN4gTNzUTNykTN5ETN8IiOiQWSisnOiQkIsISP3cXdrtCUvoEc4xUOzZ4M4UDVXR7RzImb4JTe6oVNDJkVv2WcVhDMwgHUGRWRVl4cYJWeVhGMTJDWiZ4YOJ4YsZzT5MmbWFTbZVHRlRWMtF5K7cGc58UZwIHOmlEU6FnR6tkTPpnbSVFa0lWexUHVFhFNLBHRs5kUVZlermE";

			spread = new GC.Spread.Sheets.Workbook(document.getElementById("ss"));
			config = GC.Spread.Sheets.Designer.DefaultConfig;

			config.contextMenu = config.contextMenu.concat([
				"separator",
				"DesignerInsertPageBreak",
				"DesignerInsertColPageBreak",
				"DesignerInsertRowPageBreak",
				"DesignerRemovePageBreak",
				"DesignerRemoveColPageBreak",
				"DesignerRemoveRowPageBreak"
			]);

			config.commandMap = {
				"DesignerInsertPageBreak": {
					text: contextMenuRes.insertPageBreak,
					commandName: "DesignerInsertPageBreak",
					visibleContext: "!ClickColHeader && !ClickRowHeader && !ClickCorner",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "insertPageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
						return true;
					}
				},
				"DesignerRemovePageBreak": {
					text: contextMenuRes.removePageBreak,
					commandName: "DesignerRemovePageBreak",
					visibleContext: "!ClickColHeader && !ClickRowHeader && !ClickCorner",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "removePageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
						return true;
					}
				},
				"DesignerInsertColPageBreak": {
					text: contextMenuRes.insertPageBreak,
					commandName: "DesignerInsertColPageBreak",
					visibleContext: "ClickColHeader",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "insertColPageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
						return true;
					}
				},
				"DesignerRemoveColPageBreak": {
					text: contextMenuRes.removePageBreak,
					commandName: "DesignerRemoveColPageBreak",
					visibleContext: "ClickColHeader",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "removeColPageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
						return true;
					}
				},
				"DesignerInsertRowPageBreak": {
					text: contextMenuRes.insertPageBreak,
					commandName: "DesignerInsertRowPageBreak",
					visibleContext: "ClickRowHeader",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "insertRowPageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
						return true;
					}
				},
				"DesignerRemoveRowPageBreak": {
					text: contextMenuRes.removePageBreak,
					commandName: "DesignerRemoveRowPageBreak",
					visibleContext: "ClickRowHeader",
					execute: function (designer, cmd, options) {
						var commandManager = spread.commandManager();
						commandManager.execute({ cmd: "removeRowPageBreak", sheetName: options.sheetName, row: options.activeRow, col: options.activeCol });
					}
				}
			};

			// add show/hide print lines in View Tab
			config.ribbon[4].buttonGroups[0].commandGroup.children.push({ "type": "separator" });
			config.ribbon[4].buttonGroups[0].commandGroup.children.push({
				"direction": "vertical",
				"commands": ["showHidePrintLines"]
			});

			var exported_modules = {};
			customDesignerFunctions.initDesignerCommands();
			designer = new GC.Spread.Sheets.Designer.Designer(document.getElementById("gc-designer-container"), config, spread);
		}
        //# sourceURL=localizationStuff4.js
	</script>
</body>

</html>